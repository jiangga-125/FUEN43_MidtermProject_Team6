@model IEnumerable<ReportMail.Models.ReportDefinition>

@{
    ViewData["Title"] = "報表定義清單";
}

<h1 class="mb-3">報表定義清單</h1>

<p>
    <a class="btn btn-primary" asp-action="Create">新增報表定義</a>
</p>

<div class="table-responsive">
    <table class="table table-striped table-bordered align-middle">
        <thead class="table-light">
            <tr>
                <!-- 中文化表頭 + 自訂欄位 -->
                <th>名稱</th>
                <th>分類</th>
                <th>狀態</th>
                <th>說明</th>
                <th>建立時間</th>
                <th>最後更新</th>
                <th style="width:150px">操作</th> 
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <!-- 原本顯示 Key / Name，這裡我改顯示 ReportName 和 Category （需確定 Model 有這些欄位）-->
                    <td>@item.ReportName</td>
                    <td>@item.Category</td>

                    <!-- 狀態布林值改成 Bootstrap Badge -->
                    <td>
                        @if (item.IsActive)
                        {
                            <span class="badge bg-success">啟用</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary">停用</span>
                        }
                    </td>

                    <td>@item.Description</td>

                    <!-- Scaffold 沒有格式化時間，加上 ToString 格式化 -->
                    <td>@item.CreatedAt.ToString("yyyy/MM/dd HH:mm")</td>
                    <td>@item.UpdatedAt.ToString("yyyy/MM/dd HH:mm")</td>

                    <td>
                        <a class="btn btn-sm btn-success"
                           asp-action="Run"
                           asp-route-id="@item.ReportDefinitionId">執行</a>
                        <a class="btn btn-sm btn-warning"
                           asp-action="Chart"
                           asp-route-id="@item.ReportDefinitionId">圖表</a>

                        <a class="btn btn-sm btn-outline-secondary"
                           asp-controller="ReportFilters"
                           asp-action="Index"
                           asp-route-reportDefinitionId="@item.ReportDefinitionId">欄位</a>  <!-- ★ -->
                        <a class="btn btn-sm btn-info" asp-action="Edit" asp-route-id="@item.ReportDefinitionId">編輯</a>
                        <a class="btn btn-sm btn-secondary" asp-action="Details" asp-route-id="@item.ReportDefinitionId">檢視</a>
                        <a class="btn btn-sm btn-danger" asp-action="Delete" asp-route-id="@item.ReportDefinitionId">刪除</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
